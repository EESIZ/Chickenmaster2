# Chickenmaster2
[게임 목표]
한국에서 치킨집을 경영하는 테마의 경영시뮬레이션 게임입니다.
TRPG적인 DICE 요소를 추가하여 단순히 치킨을 만들어 파는 타이쿤 게임보다는
확률적인 선택지를 통해 불확실성을 선택하고 매 플레이마다 다른 경험과
무작위적 요소를 통한 재미를 느끼게 하는것이 목표입니다.
동시에 타이쿤류 게임의 근본적인 재미 요소인 운영의 재미도 느낄 수 있어야 합니다.

[기본 규칙]
캐릭터는 3가지 중 선택합니다.
각 캐릭터는 배경 설정에 따라 다른 능력치를 갖게 되고,
각 능력치는 무작위적 요소를 보정해 좀 더 원하는 결과를 얻을 확률이 높이게 됩니다.

확률적 요소를 결정하는건 D100 다이스를 사용합니다.
해당 다이스를 사용할때에는 src/game/DiceSystem.py 을 사용합니다.
별도의 모듈을 만드는건 허용되지 않습니다.
주사위 굴림은 calldice 로 상수 값을 받아 성공 실패를 판정합니다.

게임에는 AI 경쟁자가 존재합니다,
이는 플레이어가 일방적인 Exploit을 통해 게임을 너무 쉽게 만드는 일을 방지해야합니다.
  - 2 이상의 경쟁자가 존재해야 하며, 각각 다른 전략이 존재하고, 설정된 성향에 따라 행동하게 됩니다.
  - 유저의 선택에 3턴에서 10턴 사이의 랜덤한 턴이 지난 후 반응하며, 유저의 이익을 감소시키고 자신의 이익을 증대시키기 위해 행동합니다.
  - AI 경쟁자의 목표는 이익의 극대화입니다. 단, 이것이 반드시 플레이어의 패배를 의미하진 않습니다. 필요하다면 플레이어에게 이득을 주면서라도 본인의 이익을 극대화할 수 도 있습니다.
  - 경쟁자는 기본 설정된 자금을 소진하고 0원인 채로 30일이 지나면 패배합니다.
  - 패배하는 경우 30일에서 120일 사이 랜덤한 날짜에 새로운 경쟁자를 생성하여 게임에 투입합니다. 플레이어는 이에 대해 이벤트로 알게 됩니다.
  - 신규투입된 경쟁자는 이전 경쟁자와 반드시 다른 전략을 선택합니다.
  - 경쟁자 각각은 각자의 이익 극대화를 목표로 해야합니다.

게임에는 AI 고객이 존재합니다.
고객은 상권의 전체 인구수 중 10%만이 개별적인 AI를 가지고 행동하며,
나머지는 난수와 보정치에 의해 수치적으로만 존재하고 게임에 영향을 끼치게 됩니다.
개별AI를 가진 고객은 구매여부를 결정할때, [가격] / [품질] / [인지도] / [욕구] 4가지의 요소를 고려하여 확률적으로 구매여부를 결정합니다.
 [욕구] 수치는 0에서 100 사이의 수치이며, 개별 AI의 경우 플레이어 혹은 경쟁자에게서 구매 이후 0이 되고, 매일 하루가 지날때마다 개별 고객AI마다 개별적으로 [Calldice 의 값/10] 만큼 증가합니다.
 그리고 매턴 [욕구]% 의 확률로 구매 여부를 결정하고 결과가 True인 경우, [점유율]의 확률로 플레이어 혹은 AI경쟁자의 매장에서 치킨을 구매한다.
[가격] / [품질] / [인지도] 의 합계는 [종합] 점수가 되고
모든 매장(플레이어 및 AI 경쟁자들의 매장)의 종합점수를 합한 점수에서 각각의 비율만큼을 [점유율]로 각 매장에게 할당한다.
AI 고객은 그 [점유율]을 확률로 하여 어느 매장에서 구매할지를 결정하고 구매 결과를 처리한다.
개별 AI가 아닌 나머지 인구수는 각 매장의 점유율에 따라 구매하는 방식으로 진행됩니다.
 - 예시 : 상권 전체인구 1000 인경우 -> 100명은 개별 AI에 의해 판정, 900명은 점유율에 따라 나눠짐 -> A 매장의 점유율이 10% 라면, 900명의 10%인 90명을 모수로 하여 구매여부 판단
   └ 구매여부판단 : Calldice / 90명 /7 

[가격]
각 매장 동일한 분류의 제품 가격의 평균[시장평균가격]을 구하고,
각 매장의 {[개별 제품 가격]/[시장평균가격]*100}을 개별제품의 [가격] 점수로 한다.
그리고 개별 매장에서 판매하고 있는 분류의 제품들의 [가격]점수의 평균을 그 매장의 [가격]점수로 한다.

각 제품의 가격은 참여자가 정한 매장별 판매가격이다.

[품질]
각 매장의 동일한 분류의 제품 품질의 평균[시장평균품질]을 구하고,
그리고 각 매장의 {[개별 제품 품질]/[시장평균품질]*100}을 개별제품의 [품질] 점수로 한다.
그리고 각 매장에서 판매하고 있는 같은 제품들의 [품질]점수의 평균을 그 매장의 [품질]점수로 한다.

각 제품의 품질은 매장의 [요리]스탯과 [제품]의 [연구도] 재료의 [품질]의 평균이다

[인지도]
각 참여자의 동일한 분류의 제품 인지도의 평균[시장평균인지도]을 구하고,
그리고 각 참여자의 {[개별 제품 인지도]/[시장평균인지도]*100}을 개별제품의 [인지도] 점수로 한다.
그리고 개별 참여자가 판매하고 있는 분류의 제품들의 [인지도]점수의 평균을 그 참여자의 [인지도]점수로 한다.

각 제품의 인지도는 아래와 같이 결정된다
 - 제품의 판매당 3 증가하고, 매일 1 감소한다.
 - 제품에 대해 [광고] 행동을 하는 경우 동일 카테고리 상품에 대한 경쟁자들의 [광고]에 투자한 비용보다 높은 만큼 현재 매일 증가하고, 낮은 경우 매일 1씩 증가한다.
 - 참여자의 {[점유율]*10} 만큼 각 제품의 인지도가 매일 증가한다.



[제품]
각 참여자는 1개 이상의 [제품]을 가집니다. 
치킨집이라는 테마에 맞게 기본적으로 "후라이드 치킨" 을 갖고 시작합니다.

제품의 종류를 늘리기 위해서 플레이어는 [레시피]를 획득하여야 합니다. (레시피의 획득 방법은 이벤트, 연구를 통해 랜덤하게 획득함)
참여자는 다른 참여자가 새로운 [레시피]를 획득하여 [신제품 출시]를 한 경우 관련된 이벤트가 발생하고
[레시피 카피]라는 행동을 선택하여 [CallDice, Cook]의 확률로 성공시 7턴 후 [연구도]가 0인 레시피를 얻습니다.
만약 판정 실패시 7턴 후 다시 이벤트가 발생하여 시도할 수 있습니다.
새로운 레시피는 [신제품 출시] 하여야 [제품]이 되고, [레시피]는 삭제됩니다.
원래 가지고 있는 레시피 혹은 [제품]이 [신제품 출시]한 경우 위 이벤트는 발생하지 않습니다.

제품은 [판매 중지] 할 수 있습니다. 이 경우, 해당 제품은 삭제되고, 원래의 [레시피]로 돌아갑니다.
당연히 레시피로 돌아간 제품은 점수에 영향을 주지 않게 됩니다. 
단 해당 제품으로 얻은 인지도는 0이 되고, 다시 [신제품 출시]

제품의 가격은 매턴 시작시에 [행동]을 통해 조정 할 수 있습니다.
조정의 단위는 1,000원입니다. 0원부터 1,000,000원까지 조정할 수 있습니다.

플레이어는 아래와 같은 스탯을 가집니다(Playerstats)
[요리] = cook
[경영] = management
[서비스] = service
[기술] = tech
[체력] = stamina
스탯의 초기값은 선택한 캐릭터에 따라 달라집니다.
각 스탯은 각각 경험치를 갖습니다.
각 스탯의 경험치는 해당 스탯을 통해 Calldice 를 성공할때마다 10씩 증가합니다.
경험치는 0에서 100까지 증가하며, 100이 되면 0으로 초기화되고 스탯을 1 증가시킵니다.
연구 혹은 이벤트를 통해서도 증가할 수 있습니다.

플레이어는 아래와 같은 변동치를 가집니다.
[피로도]
- [체력]의 절반 이상 쌓이는 경우 경고 메시지를 표출합니다.
- [체력]의 90% 이상 쌓이는 경우 경고 메시지를 표출합니다.
- [체력]의 값 이상 쌓이는 경우 모든 스탯을 1/2로 줄입니다. 
- [체력]의 2배 이상 쌓이는 경우 다음 턴에 제품의 판매를 포함한 어떤 행동도 할 수 없습니다.
[행복도]
- 피로도가 50% 이상인채 턴을 종료하면 감소합니다.
- 적자가 발생하면 감소합니다
- 흑자가 발생하면 증가합니다
- 피로도가 50% 미만인채 턴을 종료하면 증가합니다.
- 이벤트를 통해 증가하거나 감소합니다.
- 0에서 100까지의 수치를 가지고, 50에서 절대값이 멀어질수록 증가량의 기울기가 감소합니다.(f(x) = 50 ± A√(|x-50|/k) (A=50, k=1))

참여자(플레이어, 경쟁자AI)는 아래와 같은 변동치를 가집니다
[자금] 

[매장]
- 매장은 각 참여자들마다 1개 이상을 가질 수 있습니다.
- 반드시 초기에는 1개의 매장만 갖습니다.
- 매장에는 [제품]을 배치하고 [알바]를 추가할 수 있습니다.
- 그리고 각각 [재고]의 값이 있고 판매 1회당 재고는 1이 줄어듭니다.
- 재고는 [재료구입] 행동으로 [시장가격]에 따라 구매가능합니다.
- 재고 1은 Queue의 형태로 쌓이고, 소모되는 형태로 구현합니다.
- 만약 30일 이상 소모되지 않은 재고가 존재하게 되는 경우 [위험한 재고 있음] 이벤트를 발생시킵니다.
- *경쟁자 AI는 해당 이벤트가 발생하지 않습니다.
- 매장은 고정적인 임대료 및 관리비가 존재합니다.

[알바]
- 매장에 [알바]를 배치하는 경우
- 해당 매장에서의 피로도 상승을 1명당 20% ~ 50% 감소시킵니다. (랜덤 결정)
- [알바]만으로 매장을 운영할 수는 없습니다.
- [알바]는 각각 고유한 랜덤 한국인 이름을 가집니다.
- [알바]는 월급을 받습니다.
- 알바를 해고할 수 있습니다,

[점장]
- 점장은 [플레이어]를 대신해 두번째 이후의 매장을 운영합니다.
- 경쟁자 AI와 동일하게 간주되고 행동합니다. 
- 점장은 랜덤한 스탯을 가집니다.
- 점장 채용은 [매장]이 2개 이상이 되었을때 이벤트를 통해 고용합니다.
- 이벤트를 통해 고용하지 않는 경우 [점장]이 없는 매장은 운영되지 않습니다.
- 경쟁자 AI는 별도의 점장시스템이 없습니다

[연구]
- 플레이어와 경쟁자 AI는 다양한 항목의 연구에 투자할 수 있습니다.
- 연구에는 자금과 시간이 소요됩니다.
- 연구하는 항목마다 스탯에 따른 보정을 받습니다.
- 각 연구는 0에서 100까지 진행되고, 연구를 시작하면 매일 {1+[calldice/10]}*{관련 스테이터스}*(난이도 보정치) 만큼 증가합니다
- 각 연구항목은 정수값의 난이도가 존재합니다. 높을수록 난이도가 높고, 연구 진행속도가 더딥니다.

[턴]
- 한 턴은 1일로 간주합니다.
- 한 턴에는 9시부터 21시 까지, 총 12시간의 [시간]자원이 주어집니다.
- 게임의 1루프에 1턴이 소모됩니다.
- 이벤트는 1턴에 1개만 발생합니다. 만약 2개이상의 이벤트가 발생하게 되는 상황이 생긴다면, 난수에 의한 이벤트는 다음 턴에 확정적으로 발생하게 됩니다.

[행동]
- 플레이어와 경쟁자 AI는 시간을 소모해 [행동]을 합니다.
- 행동의 종류는 아래와 같습니다 {조리,광고,운영,연구,개인,휴식}
- 각 행동은 세부적인 행동으로 구분됩니다
  조리 = {재료준비,조리,재료점검}
  광고 = {전단지, 온라인광고, 배달앱}
  운영 = {재료주문,청소,장비점검,알바고용}
  연구 = {레시피,경영,광고,서비스}
  개인 = {휴가,학습,운동}
  휴식 
- 각 행동은 일정 시간을 반드시 소모해야하고, 휴가 및 휴식을 제외한 모든 행동의 선택은 피로도를 증가시킵니다.
- 휴식은 수면한것으로 간주하고, 시간당 16의 피로도를 감소시킵니다. 피로도는 0이하로 떨어지지 않습니다.

[이벤트]
이벤트는 매턴 조건이 만족되면 발생확률에 따라 발생합니다, 이벤트가 발생하지 않는 경우도 존재합니다.
이벤트는 조건에 따라 아래와 같이 분류합니다
- 일상 : 특별한 조건이 없고, 다른 이벤트 발생이 없는 경우 랜덤하게 발생합니다. 한번 발생한 이벤트는 쿨다운(턴)이 지날때까지 재발생하지 않습니다.
- 기회 : 특정한 조건이 달성되었을 경우에만 발생합니다. 다른 이벤트에서 특정 선택지를 선택하거나, 스테이터스가 일정 이상이거나 등..
- 선택 : 특정한 조건이 달성되었을 경우에만 발생합니다. 선택에 따라 트레이드오프적인 결과를 발생시킵니다
         (예 : 튀김기가 고장났습니다. 수리업자를 부를까요? -- Y --> 자금 -100만원, 장비가 1년간 고장나지 않음, -- N --> 피로도 +10, Tech 경험치 +50)
- 연쇄 : 다른 이벤트에 의해 연쇄적으로 발생합니다. 발생 후 쿨다운(턴)이 지난 후 확정적으로 발생합니다.
        (예: 튀김기를 수리해준 수리업자가 신제품 튀김기를 테스트해달라고 합니다. -- Y --> 품질 감소 --> 수리업자가 미안하다면서 보상을 제안했습니다 -- '괜찮습니다... 보상 거절' --> 제품 개발회사에서 보상 대신 튀김기 보상판매를 제안합니다....)
- 위기 : 게임 시작으로 부터 일정 턴이 지난 후 발생합니다. 위기는 게임의 난이도를 조절하는 역할을 해야합니다. 플레이어에게 압박을 주지만 동시에 위기를 이겨내는 경우 반드시 특별한 보상이 있어야합니다. 같은 위기는 절대 재발생하지 않습니다.

이벤트의 발생은 이벤트 모듈에 의해 발생합니다.
모듈의 구조는 아래와 같습니다
1. 발생 예정인 이벤트 체크
2. 1의 체크가 FALSE인 경우 일상이벤트를 제외한 발생 가능한 이벤트 추출
3. 2의 추출 결과가 Null인 경우 일상 이벤트 발생 여부 체크(if Calldice > 20)
4. 3의 결과가 True인 경우 일상 이벤트 랜덤하게 선택
5. 선택된 이벤트의 Cooldown이 1 이상인지 체크, 1 이상인 경우, 4로 Callback
6. 5의 결과가 0인 경우 이벤트 발생, 이벤트 처리 후 게임 루프 진행
7. 6의 결과가 FALSE인 경우 이벤트 미발생으로 판정 후 게임 루프 진행

